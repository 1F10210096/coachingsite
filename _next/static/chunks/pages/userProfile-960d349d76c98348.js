(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[846],{1588:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/userProfile",function(){return r(1003)}])},1003:function(e,t,r){"use strict";r.r(t);var n=r(5893),o=r(4857),a=r(1163),s=r(7294),l=r(9093),i=r(4076),c=r(8985),d=r.n(c);t.default=()=>{let e=(0,a.useRouter)(),[t,r]=(0,s.useState)("");(0,s.useEffect)(()=>{e.query.modal&&r("string"==typeof e.query.modal?e.query.modal:"")},[e.query]);let[c,u]=(0,s.useState)(""),[h,m]=(0,s.useState)(""),showModal=e=>{r(e)},[p,x]=(0,s.useState)("");(0,s.useEffect)(()=>{let e=(0,o.v0)(),t=(0,o.Aj)(e,e=>{e?(console.log(e),console.log(e.uid),x(e.uid)):console.log("error")});return()=>t()},[]);let logOut=async t=>{try{t.preventDefault();let r=await (0,i.kS)();console.log("ログアウト成功:",r),e.push("http://localhost:3000/")}catch(e){console.error("ログイン失敗:",e)}},[f,j]=(0,s.useState)({gameName:"",rank:""}),[g,y]=(0,s.useState)(""),[_,v]=(0,s.useState)(void 0),[w,b]=(0,s.useState)(""),handleSubmit=async e=>{e.preventDefault();let t=(0,o.v0)().currentUser;if(t){t.uid,console.log(w);try{console.log(_),await l.x.updateProfile.post({body:{selectedFile:w}})}catch(e){console.error("プロフィール更新エラー:",e)}}else console.error("ユーザーがログインしていません。")},[N,k]=(0,s.useState)([]),[C,S]=(0,s.useState)([]),fetchMyRecruitList=async()=>{try{console.log(p);let e=await l.x.fetchMyRecruitList.post({body:{Id:p}});console.log(e.body),k(e.body.user),S(e.body.user2)}catch(e){console.error("ゲームの取得に失敗しました:",e)}};(0,s.useEffect)(()=>{fetchMyRecruitList()},[p]);let[I,P]=(0,s.useState)([]),fetchMyRoomList=async e=>{try{console.log(e);let t=await l.x.fetchMyRoomList.post({body:{roomId:e}});console.log(t.body),P(t.body)}catch(e){console.error("ゲームの取得に失敗しました:",e)}},fetchMyDmList=async t=>{try{e.push("../dm?id=".concat(t))}catch(e){console.error("ゲームの取得に失敗しました:",e)}},[L,M]=(0,s.useState)(null),[D,E]=(0,s.useState)(""),[R,F]=(0,s.useState)(""),handleButtonClick=e=>{M(Number(e))},handleSubmit2=async e=>{e.preventDefault(),console.log("Submitted:",{selectedId:L,rating:D,review:R}),await l.x.reviewList.post({body:{selectedId:null!==L?L.toString():"",rating:D,review:R}})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:d().container}),(0,n.jsxs)("div",{className:d().searchContainer,children:[(0,n.jsx)("div",{className:d().searchNameContainer,children:"設定画面"}),(0,n.jsx)("div",{className:d().searchNameContainer2,children:(0,n.jsxs)("div",{className:"".concat(d().rankDropdown),onClick:()=>showModal("profile"),children:["プロフィール",(0,n.jsx)("span",{className:d().dropdownIcon})]})}),(0,n.jsx)("div",{className:d().searchNameContainer2,children:(0,n.jsxs)("div",{className:"".concat(d().rankDropdown),onClick:()=>showModal("applicationHistory"),children:["コーチング応募履歴",(0,n.jsx)("span",{className:d().dropdownIcon})]})}),(0,n.jsx)("div",{className:d().searchNameContainer2,children:(0,n.jsxs)("div",{className:"".concat(d().rankDropdown),onClick:()=>showModal("recruitmentHistory"),children:["コーチング募集履歴",(0,n.jsx)("span",{className:d().dropdownIcon})]})}),(0,n.jsx)("div",{className:d().searchNameContainer2,children:(0,n.jsxs)("div",{className:"".concat(d().rankDropdown),onClick:()=>showModal("logout"),children:["ログアウト",(0,n.jsx)("span",{className:d().dropdownIcon}),(0,n.jsx)("button",{onClick:logOut,children:"logout"})]})}),t&&(0,n.jsx)("div",{className:d().helpwanted,children:(0,n.jsxs)("div",{className:d().modal,children:["profile"===t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:"プロフィール設定"}),(0,n.jsxs)("form",{onSubmit:handleSubmit,children:[(0,n.jsx)("input",{type:"text",name:"name",value:c,onChange:e=>{u(e.target.value)},placeholder:"名前"}),(0,n.jsx)("input",{type:"text",name:"game",value:f.gameName,placeholder:"ゲーム名"}),(0,n.jsx)("input",{type:"text",name:"rank",value:f.rank,placeholder:"ランク"}),(0,n.jsx)("textarea",{name:"bio",value:h,onChange:e=>{m(e.target.value)},placeholder:"自己紹介"}),(0,n.jsx)("input",{type:"file",name:"profileImage",onChange:e=>{let t=e.target.files&&e.target.files[0];if(t){let e=URL.createObjectURL(t);y(e);let r=new FileReader;r.onload=e=>{var t;let r=null===(t=e.target)||void 0===t?void 0:t.result;b(r)},r.readAsDataURL(t)}},accept:"image/*"}),g&&(0,n.jsx)("img",{src:g,alt:"プレビュー",className:d().profileImage}),(0,n.jsx)("button",{type:"submit",children:"プロフィール更新"})]})]}),"applicationHistory"===t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:"コーチング応募履歴"}),(0,n.jsx)("ul",{children:C.map((e,t)=>(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:["応募ID: ",e.id,(0,n.jsx)("button",{onClick:()=>handleButtonClick(e.id),children:"評価する"})]}),L===Number(e.id)&&(0,n.jsxs)("form",{onSubmit:handleSubmit2,children:[(0,n.jsx)("div",{children:(0,n.jsxs)("label",{children:["評価：",(0,n.jsx)("input",{type:"number",value:D,onChange:e=>E(e.target.value)})]})}),(0,n.jsx)("div",{children:(0,n.jsxs)("label",{children:["感想：",(0,n.jsx)("textarea",{value:R,onChange:e=>F(e.target.value)})]})}),(0,n.jsx)("button",{type:"submit",children:"送信"})]})]},t))})]}),"recruitmentHistory"===t&&(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{onClick:fetchMyRecruitList,children:"コーチング応募履歴"}),N.length>0?(0,n.jsx)("ul",{children:N.map((e,t)=>(0,n.jsxs)("li",{onClick:()=>fetchMyRoomList(e.id),children:[(0,n.jsx)("h3",{children:e.title}),(0,n.jsx)("p",{children:e.description})]},t))}):(0,n.jsx)("p",{children:"募集履歴はありません。"}),I.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{children:"マイルームリスト"}),(0,n.jsx)("ul",{children:I.map((e,t)=>(0,n.jsx)("li",{onClick:()=>fetchMyDmList(e.id),children:(0,n.jsx)("h3",{children:e.id})},t))})]})]}),"logout"===t&&(0,n.jsx)("div",{children:"ログアウト処理"})]})})]})]})}},4076:function(e,t,r){"use strict";r.d(t,{fZ:function(){return loginWithEmail},kS:function(){return logout},r4:function(){return createUser}});var n=r(4857),o=r(6386),a=r(3977);let s=(0,a.C6)().length?(0,a.C6)()[0]:(0,a.ZF)({apiKey:"AIzaSyAhj-kX80rgFqCUSYvInWu65ybpo17-YEs",authDomain:"coach-35eb6.firebaseapp.com",projectId:"coach-35eb6",storageBucket:"coach-35eb6.appspot.com",messagingSenderId:"777298456996",appId:"1:777298456996:web:cedb0108040243729d9131",measurementId:"G-95LTBT1JLB"}),l=(0,n.v0)(s);console.log(l);let logout=async()=>{try{await (0,n.w7)(l)}catch(e){console.error("Logout failed:",e)}},loginWithEmail=async(e,t)=>{try{return console.log(l,e,t),console.log("loginWithEmail"),await function(e,t,r){throw Error("Function not implemented.")}(0,0,0)}catch(e){throw console.log("e4545454rror"),e}},createUser=async(e,t,r)=>{let a=await (0,n.Xb)((0,o.l)(),e,t),s=(0,o.l)().currentUser;s&&await (0,n.ck)(s,{displayName:r});let l=!a.user.emailVerified;return l&&(console.log("メールを送信しました"),await reSendVerifyMail(a.user)),a},reSendVerifyMail=async e=>{try{await (0,n.w$)(e);return}catch(e){e.code;return}}},8985:function(e){e.exports={modal:"userProfile_modal__kt7ik",helpwanted:"userProfile_helpwanted__sNjhA",searchNameContainer:"userProfile_searchNameContainer__NK1ns",searchNameContainer2:"userProfile_searchNameContainer2__PnK_A",rankContent:"userProfile_rankContent__kFqL6",rankDropdown:"userProfile_rankDropdown__d0Wne",dropdownIcon:"userProfile_dropdownIcon__pNSkY",active:"userProfile_active__3ojSK",rankCheckboxes:"userProfile_rankCheckboxes__nx_0W",search:"userProfile_search__8g6Ju",searchContainer:"userProfile_searchContainer__reqXC",container:"userProfile_container__DGhir",profileImage:"userProfile_profileImage__NHdbh"}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1588)}),_N_E=e.O()}]);