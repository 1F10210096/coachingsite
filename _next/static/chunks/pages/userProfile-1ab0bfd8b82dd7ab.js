(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[846],{1588:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/userProfile",function(){return n(1003)}])},1003:function(e,t,n){"use strict";n.r(t);var s=n(5893),a=n(6718),r=n(1163),o=n(7294),l=n(8759),i=n(2509),c=n(8985),d=n.n(c);t.default=()=>{let e=(0,r.useRouter)(),[t,n]=(0,o.useState)("");(0,o.useEffect)(()=>{e.query.modal&&n("string"==typeof e.query.modal?e.query.modal:"")},[e.query]);let[c,u]=(0,o.useState)(""),[h,m]=(0,o.useState)(""),showModal=e=>{n(e)},[p,x]=(0,o.useState)("");(0,o.useEffect)(()=>{let e=(0,i.lh)(),t=(0,a.Aj)(e,e=>{e?(console.log(e),console.log(e.uid),x(e.uid)):console.log("error")});return()=>t()},[]);let logOut=async t=>{try{t.preventDefault();let n=await (0,i.kS)();console.log("ログアウト成功:",n),e.push("http://localhost:3000/")}catch(e){console.error("ログイン失敗:",e)}},[j,f]=(0,o.useState)({gameName:"",rank:""}),[_,g]=(0,o.useState)(""),[y,v]=(0,o.useState)(void 0),[N,b]=(0,o.useState)(""),handleSubmit=async e=>{e.preventDefault();let t=(0,a.v0)().currentUser;if(t){t.uid,console.log(N);try{console.log(y),await l.x.updateProfile.post({body:{selectedFile:N}})}catch(e){console.error("プロフィール更新エラー:",e)}}else console.error("ユーザーがログインしていません。")},[k,C]=(0,o.useState)([]),[w,S]=(0,o.useState)([]),fetchMyRecruitList=async()=>{try{console.log(p);let e=await l.x.fetchMyRecruitList.post({body:{Id:p}});console.log(e.body),C(e.body.user),S(e.body.user2)}catch(e){console.error("ゲームの取得に失敗しました:",e)}};(0,o.useEffect)(()=>{fetchMyRecruitList()},[p]);let[P,D]=(0,o.useState)([]),fetchMyRoomList=async e=>{try{console.log(e);let t=await l.x.fetchMyRoomList.post({body:{roomId:e}});console.log(t.body),D(t.body)}catch(e){console.error("ゲームの取得に失敗しました:",e)}},fetchMyDmList=async t=>{try{e.push("../dm?id=".concat(t))}catch(e){console.error("ゲームの取得に失敗しました:",e)}},[L,M]=(0,o.useState)(null),[I,R]=(0,o.useState)(""),[E,q]=(0,o.useState)(""),handleButtonClick=e=>{M(Number(e))},handleSubmit2=async e=>{e.preventDefault(),console.log("Submitted:",{selectedId:L,rating:I,review:E}),await l.x.reviewList.post({body:{selectedId:null!==L?L.toString():"",rating:I,review:E}})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:d().container}),(0,s.jsxs)("div",{className:d().searchContainer,children:[(0,s.jsx)("div",{className:d().searchNameContainer,children:"設定画面"}),(0,s.jsx)("div",{className:d().searchNameContainer2,children:(0,s.jsxs)("div",{className:"".concat(d().rankDropdown),onClick:()=>showModal("profile"),children:["プロフィール",(0,s.jsx)("span",{className:d().dropdownIcon})]})}),(0,s.jsx)("div",{className:d().searchNameContainer2,children:(0,s.jsxs)("div",{className:"".concat(d().rankDropdown),onClick:()=>showModal("applicationHistory"),children:["コーチング応募履歴",(0,s.jsx)("span",{className:d().dropdownIcon})]})}),(0,s.jsx)("div",{className:d().searchNameContainer2,children:(0,s.jsxs)("div",{className:"".concat(d().rankDropdown),onClick:()=>showModal("recruitmentHistory"),children:["コーチング募集履歴",(0,s.jsx)("span",{className:d().dropdownIcon})]})}),(0,s.jsx)("div",{className:d().searchNameContainer2,children:(0,s.jsxs)("div",{className:"".concat(d().rankDropdown),onClick:()=>showModal("logout"),children:["ログアウト",(0,s.jsx)("span",{className:d().dropdownIcon}),(0,s.jsx)("button",{onClick:logOut,children:"logout"})]})}),t&&(0,s.jsx)("div",{className:d().helpwanted,children:(0,s.jsxs)("div",{className:d().modal,children:["profile"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:"プロフィール設定"}),(0,s.jsxs)("form",{onSubmit:handleSubmit,children:[(0,s.jsx)("input",{type:"text",name:"name",value:c,onChange:e=>{u(e.target.value)},placeholder:"名前"}),(0,s.jsx)("input",{type:"text",name:"game",value:j.gameName,placeholder:"ゲーム名"}),(0,s.jsx)("input",{type:"text",name:"rank",value:j.rank,placeholder:"ランク"}),(0,s.jsx)("textarea",{name:"bio",value:h,onChange:e=>{m(e.target.value)},placeholder:"自己紹介"}),(0,s.jsx)("input",{type:"file",name:"profileImage",onChange:e=>{let t=e.target.files&&e.target.files[0];if(t){let e=URL.createObjectURL(t);g(e);let n=new FileReader;n.onload=e=>{var t;let n=null===(t=e.target)||void 0===t?void 0:t.result;b(n)},n.readAsDataURL(t)}},accept:"image/*"}),_&&(0,s.jsx)("img",{src:_,alt:"プレビュー",className:d().profileImage}),(0,s.jsx)("button",{type:"submit",children:"プロフィール更新"})]})]}),"applicationHistory"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:"コーチング応募履歴"}),(0,s.jsx)("ul",{children:w.map((e,t)=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{children:["応募ID: ",e.id,(0,s.jsx)("button",{onClick:()=>handleButtonClick(e.id),children:"評価する"})]}),L===Number(e.id)&&(0,s.jsxs)("form",{onSubmit:handleSubmit2,children:[(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["評価：",(0,s.jsx)("input",{type:"number",value:I,onChange:e=>R(e.target.value)})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["感想：",(0,s.jsx)("textarea",{value:E,onChange:e=>q(e.target.value)})]})}),(0,s.jsx)("button",{type:"submit",children:"送信"})]})]},t))})]}),"recruitmentHistory"===t&&(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{onClick:fetchMyRecruitList,children:"コーチング応募履歴"}),k.length>0?(0,s.jsx)("ul",{children:k.map((e,t)=>(0,s.jsxs)("li",{onClick:()=>fetchMyRoomList(e.id),children:[(0,s.jsx)("h3",{children:e.title}),(0,s.jsx)("p",{children:e.description})]},t))}):(0,s.jsx)("p",{children:"募集履歴はありません。"}),P.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"マイルームリスト"}),(0,s.jsx)("ul",{children:P.map((e,t)=>(0,s.jsx)("li",{onClick:()=>fetchMyDmList(e.id),children:(0,s.jsx)("h3",{children:e.id})},t))})]})]}),"logout"===t&&(0,s.jsx)("div",{children:"ログアウト処理"})]})})]})]})}},8985:function(e){e.exports={modal:"userProfile_modal__kt7ik",helpwanted:"userProfile_helpwanted__sNjhA",searchNameContainer:"userProfile_searchNameContainer__NK1ns",searchNameContainer2:"userProfile_searchNameContainer2__PnK_A",rankContent:"userProfile_rankContent__kFqL6",rankDropdown:"userProfile_rankDropdown__d0Wne",dropdownIcon:"userProfile_dropdownIcon__pNSkY",active:"userProfile_active__3ojSK",rankCheckboxes:"userProfile_rankCheckboxes__nx_0W",search:"userProfile_search__8g6Ju",searchContainer:"userProfile_searchContainer__reqXC",container:"userProfile_container__DGhir",profileImage:"userProfile_profileImage__NHdbh"}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1588)}),_N_E=e.O()}]);